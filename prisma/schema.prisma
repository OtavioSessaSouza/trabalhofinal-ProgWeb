// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Paciente {
  id                String      @id @default(auto()) @map("_id") @db.ObjectId
  nome              String
  nascimento        String
  cpf               String      @unique
  contato           String
  contatoEmergencia String
  respCasoMenor     String?
  endereco          Endereco?   @relation(fields: [enderecoId], references: [id])
  prontuario        Avaliacao[]
  consulta          Consulta[]
  enderecoId        String?     @db.ObjectId
}

model Endereco {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  rua         String
  numero      Int
  complemento String
  bairro      String
  cidade      String
  estado      String
  Paciente    Paciente[]
}

model Profissional {
  id         String      @id @default(auto()) @map("_id") @db.ObjectId
  nome       String
  nascimento String
  cpf        String      @unique
  crp        String      @unique
  avaliacao  Avaliacao[]
  consulta   Consulta[]
}

model Avaliacao {
  id             String       @id @default(auto()) @map("_id") @db.ObjectId
  profissionalID String       @unique @db.ObjectId
  profissional   Profissional @relation(fields: [profissionalID], references: [id])
  pacienteID     String       @unique @db.ObjectId
  paciente       Paciente     @relation(fields: [pacienteID], references: [id])
  data           DateTime
  status         Boolean
  condicao       String
  perguntas      QA[]
}

model QA {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  pergunta    String
  resposta    String?
  Avaliacao   Avaliacao? @relation(fields: [avaliacaoId], references: [id])
  avaliacaoId String?    @db.ObjectId
}

model Consulta {
  id             String       @id @default(auto()) @map("_id") @db.ObjectId
  profissionalID String       @unique @db.ObjectId
  profissional   Profissional @relation(fields: [profissionalID], references: [id])
  pacienteID     String       @unique @db.ObjectId
  paciente       Paciente     @relation(fields: [pacienteID], references: [id])
  data           DateTime
  relatorio      String
}
